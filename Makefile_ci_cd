SERVICE_NAME ?= web-speed-test-server
IMAGE_NAME ?= ${SERVICE_NAME}
VERSION ?= ${BUILD_NUMBER}

prepare_environment:
build_ci:
	docker build --build-arg build_number=${BUILD_NUMBER} --build-arg revision=${VERSION} --build-arg srv_name=${SERVICE_NAME} --target final --tag ${IMAGE_NAME}_ci_builder ./
cleanup_ci:
test:
build:
	docker build --build-arg build_number=${BUILD_NUMBER} --build-arg revision=${VERSION} --build-arg srv_name=${SERVICE_NAME} --target final --tag ${IMAGE_NAME}:${COMMIT} --tag ${IMAGE_NAME}:dev ./
pre_deploy:
publish_artifacts:
build_dev:
post_ci: